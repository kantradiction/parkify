<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="theme-color" content="#000000">
    <!-- 
      manifest.json provides metadata used when your web app is added to the 
      homescreen on Android. See https://developers.google.com/web/fundamentals/engage-and-retain/web-app-manifest/ 
    -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.3/js/foundation.min.js" crossorigin="anonymous"></script>
<!-- Compressed CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.3.0/css/foundation.min.css" crossorigin="anonymous"
/>
<link rel="manifest" href="%PUBLIC_URL%/manifest.json">
<link rel="shortcut icon" href="%PUBLIC_URL%/favicon.ico">
<!-- 
+
      Notice the use of %PUBLIC_URL% in the tags above. 
      It will be replaced with the URL of the `public` folder during the build. 
      Only files inside the `public` folder can be referenced from the HTML. 
 
      Unlike "/favicon.ico" or "favicon.ico", "%PUBLIC_URL%/favicon.ico" will 
      work correctly both with client-side routing and a non-root public URL. 
      Learn how to configure a non-root public URL by running `npm run build`. 
    -->
<title>React App</title>
</head>
<body>
    <noscript>
        You need to enable JavaScript to run this app.
    </noscript>
    <div id="root"></div>
    <!--TOPBAR NAVIGATION =======================================================-->
    <div class="top-bar">
      <div class="top-bar-left">
        <ul class="dropdown menu" data-dropdown-menu>
            <li class="menu-text"><a href="/">Parkify</a></li>
        </ul>
      </div>
      <div class="top-bar-right">
        <ul class="dropdown menu" data-dropdown-menu>
          <li><a href="/get-owners">Get Owners</a>
          </li>
          <li><a href="/get-drivers">Get Drivers</a>
          </li>
          <li><a href="/get-parking-spots">Get Parking Spots</a>
          </li>
          <li><a href="/get-vehicles">Get Vehicles</a>
          </li>
          <li><a href="/get-rentals">Get Rentals</a>
          </li>
        </ul>
      </div>
    </div>
    <!--END TOPBAR NAVIGATION ====================================================-->
    <div class="row">
      <h2>Create Things</h2>
      <div class="row">
        <div class="medium-6 columns">
          <div class="callout primary">
            <div class="row">
              <div class="small-12 columns">
                <h3>Create Owner</h3>
                <form id="create-owner-form">
                    <div class="row">
                      <!--EMAIL-->
                      <div class="small-9 columns">
                        <label> Email
                            <input type="text" id="create-owner-email" placeholder="email"/>
                        </label>
                      </div>
                      <!--PASSWORD-->
                      <div class="small-9 columns end">
                        <label> Password
                            <input type="password" id="create-owner-password" placeholder="password"/>
                        </label>
                      </div>
                    </div>
                    <div class="row">
                      <!--FIRST NAME-->
                      <div class="small-6 columns">
                        <label> First Name
                            <input type="text" id="create-owner-first-name" placeholder="First Name"/>
                        </label>
                      </div>
                      <!--LAST NAME-->
                      <div class="small-6 columns">
                        <label> Last Name
                            <input type="text" id="create-owner-last-name" placeholder="Last Name"/>
                        </label>
                      </div>
                    </div>
                    <div class="row">
                      <!--ADDRESS-->
                      <div class="small-12 columns">
                          <label> Street
                              <input type="text" id="create-owner-street" placeholder="123 W. Main St."/>
                          </label>
                      </div>
                      <div class="small-4 columns">
                          <label> City
                              <input type="text" id="create-owner-city" placeholder="Phoenix"/>
                          </label>
                      </div>
                      <div class="small-4 columns">
                        <label> State
                            <input type="text" id="create-owner-state" placeholder="AZ"/>
                        </label>
                      </div>
                      <div class="small-4 columns">
                          <label> Zip
                              <input type="number" id="create-owner-zip" placeholder="85027"/>
                          </label>
                      </div>
                    </div>
                    <div class="row">
                      <!--PHONE NUMBER-->
                      <div class="small-9 columns">
                          <label> Phone Number
                              <input type="text" id="create-owner-phone-number" placeholder="123 456 7890"/>
                          </label> 
                      </div>
                    </div>
                    <div class="row">
                      <div class="small-12 columns">
                          <input class="button small-4" id="create-owner-button" type="submit" value="Create Owner" />
                      </div>
                    </div>
                  </form>
              </div>
            </div>
          </div>
        </div>
        <div class="medium-6 columns">
          <div class="callout primary">
            <div class="row">
              <div class="small-12 columns">
                <h3>Create Parking Spot</h3>
                <form id="create-parking-spot-form">
                  <div class="row">
                      <div class="small-9 columns">
                          <label for="">Owner
                            <select name="" id="create-parking-spot-owner-dropdown">
                              <option value="select">- SELECT -</option>
                            </select>
                          </label>
                        </div>
                      <!--ADDRESS-->
                      <div class="small-12 columns">
                          <label> Street
                              <input type="text" id="create-parking-spot-street" placeholder="123 W. Main St."/>
                          </label>
                      </div>
                      <div class="small-4 columns">
                          <label> City
                              <input type="text" id="create-parking-spot-city" placeholder="Phoenix"/>
                          </label>
                      </div>
                      <div class="small-4 columns">
                        <label> State
                            <input type="text" id="create-parking-spot-state" placeholder="AZ"/>
                        </label>
                      </div>
                      <div class="small-4 columns">
                          <label> Zip
                              <input type="number" id="create-parking-spot-zip" placeholder="85027"/>
                          </label>
                      </div>
                    </div>
                    <div class="row">
                        <div class="small-12 columns">
                            <input class="button small-4" id="create-parking-spot-button" type="submit" value="Create Parking Spot" />
                        </div>
                    </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="medium-6 columns">
            <div class="callout primary">
              <div class="row">
                <div class="small-12 columns">
                  <h3>Create Driver</h3>
                  <form id="create-driver-form">
                    <div class="row">
                      <!--EMAIL-->
                      <div class="small-9 columns">
                        <label> Email
                            <input type="text" id="create-driver-email" placeholder="Email"/>
                        </label>
                      </div>
                      <!--PASSWORD-->
                      <div class="small-9 columns end">
                        <label> Password
                            <input type="password" id="create-driver-password" placeholder="password"/>
                        </label>
                      </div>
                    </div>
                    <div class="row">
                      <!--FIRST NAME-->
                      <div class="small-6 columns">
                        <label> First Name
                            <input type="text" id="create-driver-first-name" placeholder="First Name"/>
                        </label>
                      </div>
                      <!--LAST NAME-->
                      <div class="small-6 columns">
                        <label> Last Name
                            <input type="text" id="create-driver-last-name" placeholder="Last Name"/>
                        </label>
                      </div>
                    </div>
                    <div class="row">
                      <!--ADDRESS-->
                      <div class="small-12 columns">
                          <label> Address
                              <input type="text" id="create-driver-street" placeholder="123 W. Main St."/>
                          </label>
                      </div>
                      <div class="small-4 columns">
                          <label> City
                              <input type="text" id="create-driver-city" placeholder="Phoenix"/>
                          </label>
                      </div>
                      <div class="small-4 columns">
                        <label> State
                            <input type="text" id="create-driver-state" placeholder="AZ"/>
                        </label>
                      </div>
                      <div class="small-4 columns">
                          <label> Zip
                              <input type="number" id="create-driver-zip" placeholder="85027"/>
                          </label>
                      </div>
                    </div>
                    <div class="row">
                      <!--PHONE NUMBER-->
                      <div class="small-9 columns">
                          <label> Phone Number
                              <input type="text" id="create-driver-phone-number" placeholder="123 456 7890"/>
                          </label> 
                      </div>
                    </div>
                    <div class="row">
                      <div class="small-12 columns">
                          <input class="button small-4" id="create-driver-button" type="submit" value="Create Driver" />
                      </div>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
          <div class="medium-6 columns">
            <div class="callout primary">
              <div class="row">
                <div class="small-12 columns">
                  <h3>Create Vehicle</h3>
                  <form id="create-vehicle-form">
                    <div class="row">
                        <div class="small-9 columns">
                          <label for="">Driver
                            <select name="" id="create-vehicle-driver-dropdown">
                              <option value="select">- SELECT -</option>
                            </select>
                          </label>
                        </div>
                      <div class="small-6 columns">
                        <label>Make</label>
                        <input type="text" id="create-vehicle-make" placeholder="Lexus"/>
                      </div>
                      <div class="small-6 columns">
                        <label>Model</label>
                        <input type="text" id="create-vehicle-model" placeholder="LX470"/>
                      </div>
                      <div class="small-6 columns">
                        <label>Year</label>
                        <input type="number" id="create-vehicle-year" placeholder="2000"/>
                      </div>
                      <div class="small-6 columns">
                        <label>Color</label>
                        <input type="text" id="create-vehicle-color" placeholder="Pearl"/>
                      </div>
                    </div>
                    <div class="row">
                        <div class="small-12 columns">
                            <input class="button small-4" id="create-vehicle-button" type="submit" value="Create Vehicle" />
                        </div>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
      </div>
      <div class="row">
        <div class="medium-6 columns">
          <div class="callout primary">
            <div class="row">
              <div class="small-12 columns">
                <h3>Create Rental</h3>
                <form id="create-rental-form">
                  <div class="row">
                    <div class="small-6 columns">
                      <label for="">Owner
                        <select name="" id="rental-owner-dropdown">
                          <option value="select">- SELECT -</option>
                        </select>
                      </label>
                    </div>
                    <div class="small-6 columns">
                      <label for="">Parking Spot
                        <select name="" id="rental-parking-spot-dropdown">
                        </select>
                      </label>
                    </div>
                    <div class="small-6 columns">
                      <label for="">Driver
                        <select name="" id="rental-driver-dropdown">
                          <option value="select">- SELECT -</option>
                        </select>
                      </label>
                    </div>
                    <div class="small-6 columns">
                      <label for="">Vehicle
                        <select name="" id="rental-vehicle-dropdown">
                        </select>
                      </label>
                    </div>
                    <div class="small-6 columns float-left">
                      <label>Rate</label>
                      <input type="text" id="create-rental-rate" placeholder="$10"/>
                    </div>
                  </div>
                  <div class="row">
                    <div class="small-12 columns">
                        <input class="button small-4" id="create-rental-button" type="submit" value="Create Rental" />
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
        <div class="medium-6 columns">
            <div class="callout primary">
              <div class="row">
                <div class="small-12 columns">
                  <h3>Update Rental</h3>
                  <form id="create-rental-form">
                    <div class="row">
                      <div class="small-6 columns">
                        <label for="">Rental ID
                          <select name="" id="update-rental-id-dropdown">
                            <option value="select">- SELECT -</option>
                          </select>
                        </label>
                      </div>
                    </div>
                    <div class="row">
                        <div class="small-6 columns float-left">
                          <label>Rate</label>
                          <input type="text" id="update-rental-rate" placeholder="$10"/>
                        </div>
                        <div class="small-6 columns">
                          <label for="">Status
                            <select name="" id="update-rental-status-dropdown">
                              <option value="select">- SELECT -</option>
                              <option value="new">new</option>
                              <option value="pending">pending</option>
                              <option value="active">active</option>
                              <option value="canceled">canceled</option>
                              <option value="closed">closed</option>
                            </select>
                          </label>
                        </div>
                      </div>
                    <div class="row">
                      <div class="small-12 columns">
                          <input class="button small-4" id="update-rental-button" type="submit" value="Update Rental" />
                      </div>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
      </div>
    </div>
    <script>      
      $(document).ready(function() {
        //load owners and drivers into dropdowns on page load
        //----------------------------------------------------

        //load owners
        $.ajax({
          url: "/get-owners"
        }).done(function(response) {
          for (let i = 0; i < response.length; i++) {
            $("#rental-owner-dropdown, #create-parking-spot-owner-dropdown")
              .append(
                "<option value='" + response[i]._id + "'>" + response[i].firstName + "</option>"
              );
          }
        });

        //load drivers
        $.ajax({
          url: "/get-drivers"
        }).done(function(response) {
          for (let i = 0; i < response.length; i++) {
            $("#rental-driver-dropdown, #create-vehicle-driver-dropdown")
              .append(
                "<option value='" + response[i]._id + "'>" + response[i].firstName + "</option>"
              );
          }
        });

        //load rentals
        $.ajax({
          url: "/get-rentals"
        }).done(function(response) {
          for (let i = 0; i < response.length; i++) {
            $("#update-rental-id-dropdown")
              .append(
                "<option value='" + response[i]._id + "'>" + response[i]._id + "</option>"
              );
          }
        });

        //load parking spots
        $("#rental-owner-dropdown").change(function() {
          let ownerID = $(this).val();

          $.ajax({
            url: "/get-owner/" + ownerID
          }).done(function(response) {
            let amtOfParkingSpots = response.parkingSpots.length;
            console.log(response);
            $("#rental-parking-spot-dropdown").html("");
            for (let i = 0; i < amtOfParkingSpots; i++) {
              $("#rental-parking-spot-dropdown")
              .append(
                "<option value='" + response.parkingSpots[i]._id + "'>" + response.parkingSpots[i].street + "</option>"
              );
            }
          });
        })

        //load vehicles spots
        $("#rental-driver-dropdown").change(function() {
          let driverID = $(this).val();

          $.ajax({
            url: "/get-driver/" + driverID
          }).done(function(response) {
            let amtOfVehicles = response.vehicles.length;
            console.log(amtOfVehicles);
            $("#rental-vehicle-dropdown").html("");
            for (let i = 0; i < amtOfVehicles; i++) {
              $("#rental-vehicle-dropdown")
              .append(
                "<option value='" + response.vehicles[i]._id + "'>" + response.vehicles[i].make + "</option>"
              );
            }
          });
        })
        //----------------------------------------------------

        //Temporary Objects
        $("#create-owner-button").on("click", function() {
          event.preventDefault();
          let tempOwner = {
            firstName: $('#create-owner-first-name').val().trim(),
            lastName: $('#create-owner-last-name').val().trim(),
            email: $('#create-owner-email').val().trim(),
            password: $('#create-owner-password').val().trim(),
            street: $('#create-owner-street').val().trim(),
            city: $('#create-owner-city').val().trim(),
            state: $('#create-owner-state').val().trim(),
            zip: $('#create-owner-zip').val().trim(),
            phoneNumber: $('#create-owner-phone-number').val().trim(),
            ownerCreated: Date.now()
          };

          $.post("/create-owner", tempOwner)
          .then((res) => {
            sessionStorage.setItem("ownerId", res._id)
            console.log("result");
            console.log(res);
            $("#create-owner-form").trigger("reset");
          })
          .catch((err) => {
            console.log("error");
            console.log(err);
          });
        });

        $("#create-driver-button").on("click", function() {
          event.preventDefault();
          let tempDriver = {
            firstName: $('#create-driver-first-name').val().trim(),
            lastName: $('#create-driver-last-name').val().trim(),
            email: $('#create-driver-email').val().trim(),
            password: $('#create-driver-password').val().trim(),
            street: $('#create-driver-street').val().trim(),
            city: $('#create-driver-city').val().trim(),
            state: $('#create-driver-state').val().trim(),
            zip: $('#create-driver-zip').val().trim(),
            phoneNumber: $('#create-driver-phone-number').val().trim(),
            driverCreated: Date.now()
          };

          $.post("/create-driver", tempDriver)
          .then((res) => {
            sessionStorage.setItem("driverId", res._id);
            console.log("result");
            console.log(res);
            $("#create-driver-form").trigger("reset");
          })
          .catch((err) => {
            console.log("error");
            console.log(err);
          });
        });

        $("#create-parking-spot-button").on("click", function() {
          event.preventDefault();
          let tempParkingSpot = {
            //ownerID: sessionStorage.getItem("ownerId"),
            ownerID: $("#create-parking-spot-owner-dropdown").val(),
            street: $("#create-parking-spot-street").val().trim(),
            city: $("#create-parking-spot-city").val().trim(),
            state: $("#create-parking-spot-state").val().trim(),
            zip: $("#create-parking-spot-zip").val().trim(),
            parkingSpotCreated: Date.now()
          };

          $.post("/create-parking-spot", tempParkingSpot)
          .then((res) => {
            console.log("result");
            console.log(res);
            $("#create-parking-spot-form").trigger("reset");
          })
          .catch((err) => {
            console.log("error");
            console.log(err);
          });
        });

        $("#create-vehicle-button").on("click", function() {
          event.preventDefault();
          let tempVehicle = {
            //driverID: sessionStorage.getItem("driverId"),
            driverID: $("#create-vehicle-driver-dropdown").val(),
            make: $("#create-vehicle-make").val().trim(),
            model: $("#create-vehicle-model").val().trim(),
            year: $("#create-vehicle-year").val().trim(),
            color: $("#create-vehicle-color").val().trim(),
            vehicleCreated: Date.now()
          };

          $.post("/create-vehicle", tempVehicle)
          .then((res) => {
            if (!res.errors) {
              $("#create-vehicle-form").trigger("reset");
            } 
            alert(res.message);
          })
          .catch((err) => {
            console.log("error");
            console.log(err);
          });
        });

        $("#create-rental-button").on("click", function() {
          event.preventDefault();

          let tempRental = {
            rate: $("#create-rental-rate").val().trim(),
            ownerID: $("#rental-owner-dropdown").val(),
            parkingSpotID: $("#rental-parking-spot-dropdown").val(),
            driverID: $("#rental-driver-dropdown").val(),
            vehicleID: $("#rental-vehicle-dropdown").val()
          };

          $.post("/create-rental", tempRental)
          .then((res) => {
            console.log("result");
            console.log(res);
            if (!res.errors) {
              $("#create-rental-form").trigger("reset");
              $("#rental-parking-spot-dropdown").html("");
              $("#rental-vehicle-dropdown").html("");
            } 
          })
          .catch((err) => {
            console.log("error");
            console.log(err);
          });
        });

        $("#update-rental-button").on("click", function() {
          event.preventDefault();

          let tempRental = {
            _id: $("#update-rental-id-dropdown").val(),
            rate: $("#update-rental-rate").val().trim(),
            status: $("#update-rental-status-dropdown").val(),
          };

          $.post("/update-rental/" + tempRental._id, tempRental)
          .then((res) => {
            console.log("result");
            console.log(res);
            if (!res.errors) {
              $("#create-rental-form").trigger("reset");
              $("#rental-parking-spot-dropdown").html("");
              $("#rental-vehicle-dropdown").html("");
            } 
          })
          .catch((err) => {
            console.log("error");
            console.log(err);
          });
        });
        });
    </script>
    <!-- Compressed JavaScript -->
  </body>
</html>